# TP : Mission Sauvegarde Renard - Connexion et Transfert Sécurisé

## Introduction

Face à une menace d'extinction pesant sur une espèce de renard particulière, votre mission, si vous l'acceptez, est de sécuriser les données vitales concernant cet animal. Chaque binôme dispose d'une station de recherche mobile (une OrangePi sous Kali Linux) et doit récupérer des informations cruciales depuis le serveur central (Ubuntu) pour les organiser localement. Ce TP vous guidera dans l'utilisation des outils essentiels `ssh` et `scp` pour mener à bien cette mission.

## Objectifs Pédagogiques

- Maîtriser la connexion à distance sécurisée via SSH.
- Savoir naviguer et créer une arborescence de dossiers sous Linux.
- Utiliser `scp` pour transférer des fichiers de manière sécurisée entre machines.
- Comprendre l'importance de l'organisation des données pour une mission critique.

## Prérequis

- Chaque OrangePi est connectée au réseau local.
- Vous disposez de l'adresse IP du serveur Ubuntu (par exemple : `192.168.1.100`).
- Vous disposez de l'adresse IP de votre OrangePi.
- Vous connaissez le nom d'utilisateur et le mot de passe pour vous connecter au serveur et à votre OrangePi.

## Partie 1 : Connexion à la Station Mobile (OrangePi)

Assurez-vous d'être connecté à votre OrangePi. Si ce n'est pas le cas, utilisez un terminal sur votre machine principale pour vous y connecter en SSH (si nécessaire, demandez l'IP à votre enseignant).

```bash
ssh utilisateur@<IP_OrangePi>
```

## Partie 2 : Connexion Sécurisée au Serveur Central

Depuis le terminal de votre OrangePi, établissez une connexion SSH avec le serveur Ubuntu.

1.  **Ouvrir une connexion SSH :**
    Remplacez `<utilisateur_serveur>` par votre nom d'utilisateur sur le serveur et `<IP_Serveur>` par l'adresse IP du serveur Ubuntu.

    ```bash
    ssh <utilisateur_serveur>@<IP_Serveur>
    ```
    Entrez le mot de passe lorsque demandé. Vous êtes maintenant connecté au serveur ! Le prompt de votre terminal devrait changer pour indiquer que vous êtes sur le serveur.

2.  **Explorer (brièvement) le serveur :**
    Utilisez la commande `ls` pour lister les fichiers dans le répertoire courant du serveur. Repérez les fichiers contenant les informations sur les renards (par exemple, `donnees_renard_habitat.txt`, `observations_renard_comportement.log`).

    ```bash
    ls -l
    ```

3.  **Se déconnecter du serveur :**
    Une fois l'exploration terminée, tapez `exit` pour fermer la connexion SSH et revenir au terminal de votre OrangePi.

    ```bash
    exit
    ```

## Partie 3 : Préparation de l'Espace de Stockage sur l'OrangePi

Sur votre OrangePi, vous devez créer une structure de dossiers pour organiser les données que vous allez récupérer.

1.  **Créer le dossier principal de la mission :**

    ```bash
    mkdir mission_sauvegarde_renard
    ```

2.  **Se déplacer dans le nouveau dossier :**

    ```bash
    cd mission_sauvegarde_renard
    ```

3.  **Créer des sous-dossiers thématiques :**
    Créez des dossiers pour classer les informations (par exemple : `habitat`, `comportement`, `genetique`).

    ```bash
    mkdir habitat comportement genetique observations_generales
    ```

4.  **Ajouter des fichiers sur la génétique et le comportement dans chaque dossier d'espèce :**
    Dans chaque dossier (`habitat`, `comportement`, `genetique`, `observations_generales`), créez deux fichiers vides : `genetique.txt` et `comportement.txt`.

    ```bash
    touch habitat/genetique.txt habitat/comportement.txt
    touch comportement/genetique.txt comportement/comportement.txt
    touch genetique/genetique.txt genetique/comportement.txt
    touch observations_generales/genetique.txt observations_generales/comportement.txt
    ```

5.  **Vérifier la structure :**
    Utilisez `ls` pour voir les dossiers et fichiers créés.

    ```bash
    ls habitat/
    ls comportement/
    ls genetique/
    ls observations_generales/
    ```

## Partie 4 : Récupération Sécurisée des Données (SCP)

Maintenant que votre espace de stockage est prêt sur l'OrangePi, utilisez `scp` (Secure Copy) pour copier les fichiers depuis le serveur Ubuntu vers votre OrangePi. La commande `scp` s'utilise *depuis* la machine où vous voulez recevoir les fichiers (votre OrangePi).

1.  **Copier un fichier spécifique :**
    Copiez le fichier `donnees_renard_habitat.txt` du serveur vers le dossier `habitat` de votre OrangePi. Adaptez le chemin source si nécessaire.

    ```bash
    # Syntaxe : scp <utilisateur_serveur>@<IP_Serveur>:<chemin_fichier_source_sur_serveur> <chemin_destination_sur_OrangePi>
    scp <utilisateur_serveur>@<IP_Serveur>:/chemin/vers/donnees_renard_habitat.txt ./habitat/
    ```
    *Note : Le `.` avant `/habitat/` signifie "le répertoire courant", qui est `mission_sauvegarde_renard`.*

2.  **Copier plusieurs fichiers ou un dossier :**
    Si vous devez copier plusieurs fichiers ou un dossier entier, vous pouvez utiliser des jokers (`*`) ou l'option `-r` pour la récursivité (copie de dossiers).

    *Exemple pour copier tous les fichiers `.log` du serveur :*
    ```bash
    scp <utilisateur_serveur>@<IP_Serveur>:/chemin/vers/*.log ./observations_generales/
    ```

    *Exemple pour copier un dossier complet `genetique_data` du serveur :*
    ```bash
    scp -r <utilisateur_serveur>@<IP_Serveur>:/chemin/vers/genetique_data ./genetique/
    ```

3.  **Vérifier les transferts :**
    Utilisez `ls` dans les différents sous-dossiers (`habitat`, `observations_generales`, etc.) sur votre OrangePi pour vérifier que les fichiers ont bien été copiés.

    ```bash
    ls habitat/
    ls observations_generales/
    # etc.
    ``